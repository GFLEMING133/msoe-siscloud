<div class="h100" data-model="{{= session.community_id }}">
  <div class="pull-top bg-black bb">
    <div class="white bg-black hh50 w100 center no-stuffing flex vertical-align bb-white">
      <div class="w15 center f-large">&nbsp;</div>
      <div class="w70">
        <h1 class="no-stuffing capitalize truncate fs18 lh24">Track Search</h1>
      </div>
     <div class="w15 center f-large">&nbsp;</div>
    </div>
    <div class="flex p10 bg-black w100">
      <div class="flex1center pr10 white strong uppercase">Sort By</div>

        <div class="sortBy-drop-actions" data-on-click="model.openSort">
          <div class="p5 flex strong white uppercase">
            <div class="pl5 flex1start">{{= model.track_sort}}</div>
            <div class="relative">
                <i class="SortUp fas fa-sort-up fa-2x"></i>
                <i class="SortDown fas fa-sort-down fa-2x"></i>
            </div>
          </div>
        </div>
      <div class="flex1center clickable" data-on-click="model.download_wc">
        <div class="clickable " data-if="{{= model.download_cloud }} == true">
          <i class=" white pl10 fs24 fas fa-cloud-download-alt"></i>
        </div>
      </div>
    </div>
    <div class="sortBy-container-contents">
      <ul class="flex-column p10 fs14">
        <li class="clickable mb10 blue-hover"
            data-on-click="model.sort_function"
            data-on-click="publish"
            data-publish="session:active"
            data-msg="newest designs">
          <a class="white strong blue-hover">NEWEST DESIGNS</a></li>
        <li class="clickable mb10 blue-hover"
            data-on-click="model.sort_function"
            data-on-click="publish"
            data-publish="session:active"
            data-msg="most popular">
          <a class="white strong blue-hover">MOST POPULAR</a></li>
        <li class="clickable mb10"
            data-on-click="model.sort_function"
            data-on-click="publish"
            data-msg="name">
          <a class="white strong blue-hover">NAME</a></li>
        <li class="clickable blue-hover"
            data-on-click="model.sort_function"
            data-on-click="publish"
            data-publish="session:active"
            data-msg="artist">
          <a class="white strong blue-hover">ARTIST</a></li>
        <div data-if="{{= model.sorting }} == true">
          <div class="mb10 white" data-template="spinner-bounce-tmp"></div>
        </div>
      </ul>
    </div>
  </div>
  
  <div class="body-header h100 pb160 media_pb200 scroll hide-scrollbar" data-run="model.fetch_community_tracks">
    <div class="pt100" data-if="{{= model.fetching_community_tracks }} == true">
      <div class="p20 center i">Fetching tracks...</div>
      <div class="mb20 black" data-template="spinner-bounce-tmp"></div>
    </div> 
    <div class="mt50" data-if="{{= model.fetching_community_tracks }} == false" >
      <div data-if="{{= _.size(model.community_track_ids) }} > {{= model.limit }}">
        <div class="flex-row bb-dcdc hh50 bg-black">
          <div class="flex1center">
            <div class="flex1center white blue-hover clickable blue-hover"
              data-if="{{= model.offset }} > 0"
              data-on-click="set"
              data-field="model.offset"
              data-msg="{{= 0 }}">
              <i class="fs18 align-end fas fa-fast-backward"></i>
            </div>
            <div class="flex1center white blue-hover clickable"
              data-if="{{= model.offset }} > 0"
              data-on-click="set"
              data-field="model.offset"
              data-msg="{{= (+model.offset - +model.limit) }}">
              <i class="fs26 fas fa-caret-left"></i>
            </div>
            <div class="flex1center" data-if="{{= model.offset }} == 0">
              <i class="fs18 align-end fas fa-fast-backward"></i>
            </div>
            <div class="flex1center" data-if="{{= model.offset }} == 0">
              <i class="fs26 fas fa-caret-left"></i>
            </div>
          </div>
          <div class="flex1center">
            <div class="flex1center white uppercase blue-hover clickable"
              data-if="{{= (+model.offset + +model.limit) }} < {{= _.size(model.community_track_ids) }}"
              data-on-click="set"
              data-field="model.offset"
              data-msg="{{= (+model.offset + +model.limit) }}">
              <i class="fs26 fas fa-caret-right"></i>
            </div>
            <div class="flex1center white blue-hover clickable"
              data-if="{{= (+model.offset + +model.limit) }} < {{= _.size(model.community_track_ids) }}"
              data-on-click="set"
              data-field="model.offset"
              data-msg="{{= (Math.floor(_.size(model.community_track_ids)/ +model.limit) * +model.limit) }}">
              <i class="fs18 align-end fas fa-fast-forward"></i>
            </div>
            <div class="flex1center" data-if="{{= (+model.offset + +model.limit) }} >= {{= _.size(model.community_track_ids) }}">
              <i class="fs26 fas fa-caret-right"></i>
            </div>
            <div class="flex1center" data-if="{{= (+model.offset + +model.limit) }} >= {{= _.size(model.community_track_ids) }}">
              <i class="fs18 align-end fas fa-fast-forward"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div data-if="{{= model.fetching_community_tracks }} == false">
        <!-- <div class="red">{{= _.indexOf(model.community_track_ids) }}</div> -->
      <div class="" data-if="{{= _.size(model.community_track_ids) }} > 0"
          data-foreach="model.community_track_ids"
          data-foreach-map="true"
          data-foreach-limit="{{= model.limit }}"
          data-foreach-offset="{{= model.offset }}">
        <div data-template="sisyphus-community-tracks-list-item-tmp"></div>
      </div>
      <div class="p20 center fs18 white i"
          data-if="{{= _.size(model.community_track_ids) }} == 0">
          There are no new tracks to download.
      </div>
      <div data-if="{{= _.size(model.community_track_ids) }} > {{= model.limit }}">
        <div data-if="{{= _.size(model.community_track_ids) }} > 0">
          <div class="flex-row bg-black hh50">
            <div class="flex1center">
              <div class="flex1center white uppercase blue-hover clickable"
                data-if="{{= model.offset }} > 0"
                data-on-click="set"
                data-field="model.offset"
                data-msg="{{= 0 }}">
                <i class="fs18 align-end fas fa-fast-backward"></i>
              </div>
              <div class="flex1center white uppercase blue-hover clickable"
                data-if="{{= model.offset }} > 0"
                data-on-click="set"
                data-field="model.offset"
                data-msg="{{= (+model.offset - +model.limit) }}">
                <i class="fs26 fas fa-caret-left"></i>
              </div>
              <div class="flex1center" data-if="{{= model.offset }} == 0">
                <i class="fs18 align-end fas fa-fast-backward"></i>
              </div>
              <div class="flex1center" data-if="{{= model.offset }} == 0">
                <i class="fs26 fas fa-caret-left"></i>
              </div>
            </div>
            <div class="flex1center">
              <div class="flex1center white uppercase blue-hover clickable"
                data-if="{{= (+model.offset + +model.limit) }} < {{= _.size(model.community_track_ids) }}"
                data-on-click="set"
                data-field="model.offset"
                data-msg="{{= (+model.offset + +model.limit) }}">
                <i class="fs26 fas fa-caret-right"></i>
              </div>
              <div class="flex1center white blue-hover clickable"
                data-if="{{= (+model.offset + +model.limit) }} < {{= _.size(model.community_track_ids) }}"
                data-on-click="set"
                data-field="model.offset"
                data-msg="{{= (Math.floor(_.size(model.community_track_ids)/ +model.limit) * +model.limit) }}">
                <i class="fs18 align-end fas fa-fast-forward"></i>
              </div>
              <div class="flex1center" data-if="{{= (+model.offset + +model.limit) }} >= {{= _.size(model.community_track_ids) }}">
                <i class="fs26 fas fa-caret-right"></i>
              </div>
              <div class="flex1center" data-if="{{= (+model.offset + +model.limit) }} >= {{= _.size(model.community_track_ids) }}">
                <i class="fs18 align-end fas fa-fast-forward"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
