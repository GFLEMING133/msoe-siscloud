!function(t){var e="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(n,i,a){e.Backbone=t(e,a,n,i)});else if("undefined"!=typeof exports){var n,i=require("underscore");try{n=require("jquery")}catch(a){}t(e,exports,i,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(function(t,e,n,i){var a=t.Backbone,r=Array.prototype.slice;e.VERSION="1.3.3",e.$=i,e.noConflict=function(){return t.Backbone=a,this},e.emulateHTTP=!1,e.emulateJSON=!1;var o=function(t,e,i){switch(t){case 1:return function(){return n[e](this[i])};case 2:return function(t){return n[e](this[i],t)};case 3:return function(t,a){return n[e](this[i],l(t,this),a)};case 4:return function(t,a,r){return n[e](this[i],l(t,this),a,r)};default:return function(){var t=r.call(arguments);return t.unshift(this[i]),n[e].apply(n,t)}}},s=function(t,e,i){n.each(e,function(e,a){n[a]&&(t.prototype[a]=o(e,a,i))})},l=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?u(t):n.isString(t)?function(e){return e.get(t)}:t},u=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}},d=e.Events={},c=/\s+/,h=function(t,e,i,a,r){var o,s=0;if(i&&"object"==typeof i){void 0!==a&&"context"in r&&void 0===r.context&&(r.context=a);for(o=n.keys(i);s<o.length;s++)e=h(t,e,o[s],i[o[s]],r)}else if(i&&c.test(i))for(o=i.split(c);s<o.length;s++)e=t(e,o[s],a,r);else e=t(e,i,a,r);return e};d.on=function(t,e,n){return f(this,t,e,n)};var f=function(t,e,n,i,a){if(t._events=h(g,t._events||{},e,n,{context:i,ctx:t,listening:a}),a){var r=t._listeners||(t._listeners={});r[a.id]=a}return t};d.listenTo=function(t,e,i){if(!t)return this;var a=t._listenId||(t._listenId=n.uniqueId("l")),r=this._listeningTo||(this._listeningTo={}),o=r[a];if(!o){var s=this._listenId||(this._listenId=n.uniqueId("l"));o=r[a]={obj:t,objId:a,id:s,listeningTo:r,count:0}}return f(t,e,i,this,o),this};var g=function(t,e,n,i){if(n){var a=t[e]||(t[e]=[]),r=i.context,o=i.ctx,s=i.listening;s&&s.count++,a.push({callback:n,context:r,ctx:r||o,listening:s})}return t};d.off=function(t,e,n){return this._events?(this._events=h(p,this._events,t,e,{context:n,listeners:this._listeners}),this):this},d.stopListening=function(t,e,i){var a=this._listeningTo;if(!a)return this;for(var r=t?[t._listenId]:n.keys(a),o=0;o<r.length;o++){var s=a[r[o]];if(!s)break;s.obj.off(e,i,this)}return this};var p=function(t,e,i,a){if(t){var r,o=0,s=a.context,l=a.listeners;if(e||i||s){for(var u=e?[e]:n.keys(t);o<u.length;o++){e=u[o];var d=t[e];if(!d)break;for(var c=[],h=0;h<d.length;h++){var f=d[h];i&&i!==f.callback&&i!==f.callback._callback||s&&s!==f.context?c.push(f):(r=f.listening,r&&0===--r.count&&(delete l[r.id],delete r.listeningTo[r.objId]))}c.length?t[e]=c:delete t[e]}return t}for(var g=n.keys(l);o<g.length;o++)r=l[g[o]],delete l[r.id],delete r.listeningTo[r.objId]}};d.once=function(t,e,i){var a=h(m,{},t,e,n.bind(this.off,this));return"string"==typeof t&&null==i&&(e=void 0),this.on(a,e,i)},d.listenToOnce=function(t,e,i){var a=h(m,{},e,i,n.bind(this.stopListening,this,t));return this.listenTo(t,a)};var m=function(t,e,i,a){if(i){var r=t[e]=n.once(function(){a(e,r),i.apply(this,arguments)});r._callback=i}return t};d.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),i=0;e>i;i++)n[i]=arguments[i+1];return h(v,this._events,t,void 0,n),this};var v=function(t,e,n,i){if(t){var a=t[e],r=t.all;a&&r&&(r=r.slice()),a&&b(a,i),r&&b(r,[e].concat(i))}return t},b=function(t,e){var n,i=-1,a=t.length,r=e[0],o=e[1],s=e[2];switch(e.length){case 0:for(;++i<a;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<a;)(n=t[i]).callback.call(n.ctx,r);return;case 2:for(;++i<a;)(n=t[i]).callback.call(n.ctx,r,o);return;case 3:for(;++i<a;)(n=t[i]).callback.call(n.ctx,r,o,s);return;default:for(;++i<a;)(n=t[i]).callback.apply(n.ctx,e);return}};d.bind=d.on,d.unbind=d.off,n.extend(e,d);var y=e.Model=function(t,e){var i=t||{};e||(e={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(i=this.parse(i,e)||{});var a=n.result(this,"defaults");i=n.defaults(n.extend({},a,i),a),this.set(i,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(y.prototype,d,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,i){if(null==t)return this;var a;if("object"==typeof t?(a=t,i=e):(a={})[t]=e,i||(i={}),!this._validate(a,i))return!1;var r=i.unset,o=i.silent,s=[],l=this._changing;this._changing=!0,l||(this._previousAttributes=n.clone(this.attributes),this.changed={});var u=this.attributes,d=this.changed,c=this._previousAttributes;for(var h in a)e=a[h],n.isEqual(u[h],e)||s.push(h),n.isEqual(c[h],e)?delete d[h]:d[h]=e,r?delete u[h]:u[h]=e;if(this.idAttribute in a&&(this.id=this.get(this.idAttribute)),!o){s.length&&(this._pending=i);for(var f=0;f<s.length;f++)this.trigger("change:"+s[f],this,u[s[f]],i)}if(l)return this;if(!o)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var i in this.attributes)e[i]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e=this._changing?this._previousAttributes:this.attributes,i={};for(var a in t){var r=t[a];n.isEqual(e[a],r)||(i[a]=r)}return n.size(i)?i:!1},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,i=t.success;return t.success=function(n){var a=t.parse?e.parse(n,t):n;return e.set(a,t)?(i&&i.call(t.context,e,n,t),void e.trigger("sync",e,n,t)):!1},z(this,t),this.sync("read",this,t)},save:function(t,e,i){var a;null==t||"object"==typeof t?(a=t,i=e):(a={})[t]=e,i=n.extend({validate:!0,parse:!0},i);var r=i.wait;if(a&&!r){if(!this.set(a,i))return!1}else if(!this._validate(a,i))return!1;var o=this,s=i.success,l=this.attributes;i.success=function(t){o.attributes=l;var e=i.parse?o.parse(t,i):t;return r&&(e=n.extend({},a,e)),e&&!o.set(e,i)?!1:(s&&s.call(i.context,o,t,i),void o.trigger("sync",o,t,i))},z(this,i),a&&r&&(this.attributes=n.extend({},l,a));var u=this.isNew()?"create":i.patch?"patch":"update";"patch"!==u||i.attrs||(i.attrs=a);var d=this.sync(u,this,i);return this.attributes=l,d},destroy:function(t){t=t?n.clone(t):{};var e=this,i=t.success,a=t.wait,r=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){a&&r(),i&&i.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var o=!1;return this.isNew()?n.defer(t.success):(z(this,t),o=this.sync("delete",this,t)),a||r(),o},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||Y();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.extend({},t,{validate:!0}))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var i=this.validationError=this.validate(t,e)||null;return i?(this.trigger("invalid",this,i,n.extend(e,{validationError:i})),!1):!0}});var x={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};s(y,x,"attributes");var _=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},k={add:!0,remove:!0,merge:!0},w={add:!0,remove:!1},M=function(t,e,n){n=Math.min(Math.max(n,0),t.length);var i,a=Array(t.length-n),r=e.length;for(i=0;i<a.length;i++)a[i]=t[i+n];for(i=0;r>i;i++)t[i+n]=e[i];for(i=0;i<a.length;i++)t[i+r+n]=a[i]};n.extend(_.prototype,d,{model:y,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,w))},remove:function(t,e){e=n.extend({},e);var i=!n.isArray(t);t=i?[t]:t.slice();var a=this._removeModels(t,e);return!e.silent&&a.length&&(e.changes={added:[],merged:[],removed:a},this.trigger("update",this,e)),i?a[0]:a},set:function(t,e){if(null!=t){e=n.extend({},k,e),e.parse&&!this._isModel(t)&&(t=this.parse(t,e)||[]);var i=!n.isArray(t);t=i?[t]:t.slice();var a=e.at;null!=a&&(a=+a),a>this.length&&(a=this.length),0>a&&(a+=this.length+1);var r,o,s=[],l=[],u=[],d=[],c={},h=e.add,f=e.merge,g=e.remove,p=!1,m=this.comparator&&null==a&&e.sort!==!1,v=n.isString(this.comparator)?this.comparator:null;for(o=0;o<t.length;o++){r=t[o];var b=this.get(r);if(b){if(f&&r!==b){var y=this._isModel(r)?r.attributes:r;e.parse&&(y=b.parse(y,e)),b.set(y,e),u.push(b),m&&!p&&(p=b.hasChanged(v))}c[b.cid]||(c[b.cid]=!0,s.push(b)),t[o]=b}else h&&(r=t[o]=this._prepareModel(r,e),r&&(l.push(r),this._addReference(r,e),c[r.cid]=!0,s.push(r)))}if(g){for(o=0;o<this.length;o++)r=this.models[o],c[r.cid]||d.push(r);d.length&&this._removeModels(d,e)}var x=!1,_=!m&&h&&g;if(s.length&&_?(x=this.length!==s.length||n.some(this.models,function(t,e){return t!==s[e]}),this.models.length=0,M(this.models,s,0),this.length=this.models.length):l.length&&(m&&(p=!0),M(this.models,l,null==a?this.length:a),this.length=this.models.length),p&&this.sort({silent:!0}),!e.silent){for(o=0;o<l.length;o++)null!=a&&(e.index=a+o),r=l[o],r.trigger("add",r,this,e);(p||x)&&this.trigger("sort",this,e),(l.length||d.length||u.length)&&(e.changes={added:l,removed:d,merged:u},this.trigger("update",this,e))}return i?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var i=0;i<this.models.length;i++)this._removeReference(this.models[i],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return r.apply(this.models,arguments)},get:function(t){return null==t?void 0:this._byId[t]||this._byId[this.modelId(t.attributes||t)]||t.cid&&this._byId[t.cid]},has:function(t){return null!=this.get(t)},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw Error("Cannot sort a set without a comparator");t||(t={});var i=e.length;return n.isFunction(e)&&(e=n.bind(e,this)),1===i||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return this.map(t+"")},fetch:function(t){t=n.extend({parse:!0},t);var e=t.success,i=this;return t.success=function(n){var a=t.reset?"reset":"set";i[a](n,t),e&&e.call(t.context,i,n,t),i.trigger("sync",i,n,t)},z(this,t),this.sync("read",this,t)},create:function(t,e){e=e?n.clone(e):{};var i=e.wait;if(t=this._prepareModel(t,e),!t)return!1;i||this.add(t,e);var a=this,r=e.success;return e.success=function(t,e,n){i&&a.add(t,n),r&&r.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?n.clone(e):{},e.collection=this;var i=new this.model(t,e);return i.validationError?(this.trigger("invalid",this,i.validationError,e),!1):i},_removeModels:function(t,e){for(var n=[],i=0;i<t.length;i++){var a=this.get(t[i]);if(a){var r=this.indexOf(a);this.models.splice(r,1),this.length--,delete this._byId[a.cid];var o=this.modelId(a.attributes);null!=o&&delete this._byId[o],e.silent||(e.index=r,a.trigger("remove",a,this,e)),n.push(a),this._removeReference(a,e)}}return n},_isModel:function(t){return t instanceof y},_addReference:function(t){this._byId[t.cid]=t;var e=this.modelId(t.attributes);null!=e&&(this._byId[e]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t){delete this._byId[t.cid];var e=this.modelId(t.attributes);null!=e&&delete this._byId[e],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,i){if(e){if(("add"===t||"remove"===t)&&n!==this)return;if("destroy"===t&&this.remove(e,i),"change"===t){var a=this.modelId(e.previousAttributes()),r=this.modelId(e.attributes);a!==r&&(null!=a&&delete this._byId[a],null!=r&&(this._byId[r]=e))}}this.trigger.apply(this,arguments)}});var S={forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3};s(_,S,"models");var D=e.View=function(t){this.cid=n.uniqueId("view"),n.extend(this,n.pick(t,T)),this._ensureElement(),this.initialize.apply(this,arguments)},C=/^(\S+)\s*(.*)$/,T=["model","collection","el","id","attributes","className","tagName","events"];n.extend(D.prototype,d,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var i=t[e];if(n.isFunction(i)||(i=this[i]),i){var a=e.match(C);this.delegate(a[1],a[2],n.bind(i,this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,i,a){var r=I[t];n.defaults(a||(a={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:r,dataType:"json"};if(a.url||(o.url=n.result(i,"url")||Y()),null!=a.data||!i||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(a.attrs||i.toJSON(a))),a.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),a.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){o.type="POST",a.emulateJSON&&(o.data._method=r);var s=a.beforeSend;a.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r),s?s.apply(this,arguments):void 0}}"GET"===o.type||a.emulateJSON||(o.processData=!1);var l=a.error;a.error=function(t,e,n){a.textStatus=e,a.errorThrown=n,l&&l.call(a.context,t,e,n)};var u=a.xhr=e.ajax(n.extend(o,a));return i.trigger("request",i,u,a),u};var I={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var P=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},A=/\((.*?)\)/g,F=/(\(\?)?:\w+/g,O=/\*\w+/g,R=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(P.prototype,d,{initialize:function(){},route:function(t,i,a){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(i)&&(a=i,i=""),a||(a=this[i]);var r=this;return e.history.route(t,function(n){var o=r._extractParameters(t,n);r.execute(a,o,i)!==!1&&(r.trigger.apply(r,["route:"+i].concat(o)),r.trigger("route",i,o),e.history.trigger("route",r,i,o))}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(R,"\\$&").replace(A,"(?:$1)?").replace(F,function(t,e){return e?t:"([^/?]+)"}).replace(O,"([^?]*?)"),RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var i=t.exec(e).slice(1);return n.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}});var L=e.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},W=/^[#\/]|\s+$/g,V=/^\/+|\/+$/g,B=/#.*$/;L.started=!1,n.extend(L.prototype,d,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(W,"")},start:function(t){if(L.started)throw Error("Backbone.history has already been started");if(L.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(V,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,a=i.insertBefore(this.iframe,i.firstChild).contentWindow;a.document.open(),a.document.close(),a.location.hash="#"+this.fragment}var r=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};return this._usePushState?r("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?r("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),L.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getHash(this.iframe.contentWindow)),t===this.fragment?!1:(this.iframe&&this.navigate(t),void this.loadUrl())},loadUrl:function(t){return this.matchRoot()?(t=this.fragment=this.getFragment(t),n.some(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})):!1},navigate:function(t,e){if(!L.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;(""===t||"?"===t.charAt(0))&&(n=n.slice(0,-1)||"/");var i=n+t;if(t=this.decodeFragment(t.replace(B,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var a=this.iframe.contentWindow;e.replace||(a.document.open(),a.document.close()),this._updateHash(a.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),e.history=new L;var E=function(t,e){var i,a=this;return i=t&&n.has(t,"constructor")?t.constructor:function(){return a.apply(this,arguments)},n.extend(i,a,e),i.prototype=n.create(a.prototype,t),i.prototype.constructor=i,i.__super__=a.prototype,i};y.extend=_.extend=P.extend=D.extend=L.extend=E;var Y=function(){throw Error('A "url" property or function must be specified')},z=function(t,e){var n=e.error;e.error=function(i){n&&n.call(e.context,t,i,e),t.trigger("error",t,i,e)}};return e});
